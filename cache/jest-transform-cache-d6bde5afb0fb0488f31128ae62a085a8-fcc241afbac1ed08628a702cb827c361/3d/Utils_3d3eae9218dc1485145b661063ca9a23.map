{"version":3,"mappings":"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","names":["getAdapter","makeOptions","isCustomComponent","isCustomComponentElement","propsOfNode","typeOfNode","nodeHasType","nodeMatches","nodeEqual","containsChildrenSubArray","childrenToSimplifiedArray","isReactElementAlike","withSetStateAllowed","AND","displayNameOfNode","sym","privateSet","cloneElement","spyMethod","isEmptyValue","renderedDive","loadCheerioRoot","ITERATOR_SYMBOL","Symbol","iterator","options","console","warn","validateMountOptions","attachTo","hydrateIn","TypeError","configAttachTo","configHydrateIn","config","finalAttachTo","undefined","finalHydrateIn","mountTargets","component","adapter","inst","isValidElement","type","node","props","filter","value","reduce","acc","key","displayName","name","internalChildrenCompare","a","b","lenComp","isLoose","nodeCompare","Array","isArray","flatA","Infinity","flatB","length","i","childrenMatch","childrenEqual","removeNullaryReducer","addition","internalNodeCompare","left","right","leftKeys","Object","keys","prop","_typeof","leftHasChildren","rightHasChildren","childCompare","children","isTextualNode","rightKeys","is","match","subArray","checker","_","arraysEqual","slice","some","every","el","childrenToArray","result","push","forEach","nodeChildren","childrenArray","simplifiedArray","child","previousChild","pop","map","x","arg","fn","cleanup","global","document","fns","fnsReversed","reverse","s","obj","defineProperty","enumerable","writable","createElement","instance","methodName","getStub","lastReturnValue","originalMethod","hasOwn","descriptor","getOwnPropertyDescriptor","configurable","spied","args","arguments","apply","restore","getLastReturnValue","renderedValue","nodes","concat","n","rendered","html","cheerio","root","load"],"sources":["../src/Utils.js"],"sourcesContent":["/* eslint no-use-before-define: 0 */\nimport isEqual from 'lodash.isequal';\nimport is from 'object-is';\nimport entries from 'object.entries';\nimport functionName from 'function.prototype.name';\nimport has from 'has';\nimport flat from 'array.prototype.flat';\nimport trim from 'string.prototype.trim';\nimport cheerio from 'cheerio';\nimport { isHtml } from 'cheerio/lib/utils';\n\nimport { get } from './configuration';\nimport { childrenOfNode } from './RSTTraversal';\nimport realGetAdapter from './getAdapter';\nimport validateAdapter from './validateAdapter';\n\nexport const ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\n\nexport function getAdapter(options = {}) {\n  console.warn('getAdapter from Utils is deprecated; please use ./getAdapter instead');\n  return realGetAdapter(options);\n}\n\nfunction validateMountOptions(attachTo, hydrateIn) {\n  if (attachTo && hydrateIn && attachTo !== hydrateIn) {\n    throw new TypeError('If both the `attachTo` and `hydrateIn` options are provided, they must be === (for backwards compatibility)');\n  }\n}\n\nexport function makeOptions(options) {\n  const { attachTo: configAttachTo, hydrateIn: configHydrateIn, ...config } = get();\n  validateMountOptions(configAttachTo, configHydrateIn);\n\n  const { attachTo, hydrateIn } = options;\n  validateMountOptions(attachTo, hydrateIn);\n\n  // neither present: both undefined\n  // only attachTo present: attachTo set, hydrateIn undefined\n  // only hydrateIn present: both set to hydrateIn\n  // both present (and ===, per above): both set to hydrateIn\n  const finalAttachTo = hydrateIn || configHydrateIn || configAttachTo || attachTo || undefined;\n  const finalHydrateIn = hydrateIn || configHydrateIn || undefined;\n  const mountTargets = {\n    ...(finalAttachTo && { attachTo: finalAttachTo }),\n    ...(finalHydrateIn && { hydrateIn: finalHydrateIn }),\n  };\n\n  return {\n    ...config,\n    ...options,\n    ...mountTargets,\n  };\n}\n\nexport function isCustomComponent(component, adapter) {\n  validateAdapter(adapter);\n  if (adapter.isCustomComponent) {\n    return !!adapter.isCustomComponent(component);\n  }\n  return typeof component === 'function';\n}\n\nexport function isCustomComponentElement(inst, adapter) {\n  if (adapter.isCustomComponentElement) {\n    return !!adapter.isCustomComponentElement(inst);\n  }\n  return !!inst && adapter.isValidElement(inst) && typeof inst.type === 'function';\n}\n\nexport function propsOfNode(node) {\n  return entries((node && node.props) || {})\n    .filter(([, value]) => typeof value !== 'undefined')\n    .reduce((acc, [key, value]) => Object.assign(acc, { [key]: value }), {});\n}\n\nexport function typeOfNode(node) {\n  return node ? node.type : null;\n}\n\nexport function nodeHasType(node, type) {\n  if (!type || !node) return false;\n\n  const adapter = realGetAdapter();\n  if (adapter.displayNameOfNode) {\n    const displayName = adapter.displayNameOfNode(node);\n    return displayName === type;\n  }\n\n  if (!node.type) return false;\n  if (typeof node.type === 'string') return node.type === type;\n  return (\n    typeof node.type === 'function' ? functionName(node.type) === type : node.type.name === type\n  ) || node.type.displayName === type;\n}\n\nfunction internalChildrenCompare(a, b, lenComp, isLoose) {\n  const nodeCompare = isLoose ? nodeMatches : nodeEqual;\n\n  if (a === b) return true;\n  if (!Array.isArray(a) && !Array.isArray(b)) {\n    return nodeCompare(a, b, lenComp);\n  }\n  const flatA = flat(a, Infinity);\n  const flatB = flat(b, Infinity);\n  if (flatA.length !== flatB.length) return false;\n  if (flatA.length === 0 && flatB.length === 0) return true;\n  for (let i = 0; i < flatA.length; i += 1) {\n    if (!nodeCompare(flatA[i], flatB[i], lenComp)) return false;\n  }\n  return true;\n}\n\nfunction childrenMatch(a, b, lenComp) {\n  return internalChildrenCompare(a, b, lenComp, true);\n}\n\nfunction childrenEqual(a, b, lenComp) {\n  return internalChildrenCompare(a, b, lenComp, false);\n}\n\nfunction removeNullaryReducer(acc, [key, value]) {\n  const addition = value == null ? {} : { [key]: value };\n  return { ...acc, ...addition };\n}\n\nfunction internalNodeCompare(a, b, lenComp, isLoose) {\n  if (a === b) return true;\n  if (!a || !b) return false;\n  if (a.type !== b.type) return false;\n\n  let left = propsOfNode(a);\n  let right = propsOfNode(b);\n  if (isLoose) {\n    left = entries(left).reduce(removeNullaryReducer, {});\n    right = entries(right).reduce(removeNullaryReducer, {});\n  }\n\n  const leftKeys = Object.keys(left);\n  for (let i = 0; i < leftKeys.length; i += 1) {\n    const prop = leftKeys[i];\n    // we will check children later\n    if (prop === 'children') {\n      // continue;\n    } else if (!(prop in right)) {\n      return false;\n    } else if (right[prop] === left[prop]) {\n      // continue;\n    } else if (typeof right[prop] === typeof left[prop] && typeof left[prop] === 'object') {\n      if (!isEqual(left[prop], right[prop])) return false;\n    } else {\n      return false;\n    }\n  }\n\n  const leftHasChildren = 'children' in left;\n  const rightHasChildren = 'children' in right;\n  const childCompare = isLoose ? childrenMatch : childrenEqual;\n  if (leftHasChildren || rightHasChildren) {\n    if (!childCompare(\n      childrenToSimplifiedArray(left.children, isLoose),\n      childrenToSimplifiedArray(right.children, isLoose),\n      lenComp,\n    )) {\n      return false;\n    }\n  }\n\n  if (!isTextualNode(a)) {\n    const rightKeys = Object.keys(right);\n    return lenComp(leftKeys.length - leftHasChildren, rightKeys.length - rightHasChildren);\n  }\n\n  return false;\n}\n\nexport function nodeMatches(a, b, lenComp = is) {\n  return internalNodeCompare(a, b, lenComp, true);\n}\n\nexport function nodeEqual(a, b, lenComp = is) {\n  return internalNodeCompare(a, b, lenComp, false);\n}\n\nexport function containsChildrenSubArray(match, node, subArray) {\n  const children = childrenOfNode(node);\n  const checker = (_, i) => arraysEqual(match, children.slice(i, i + subArray.length), subArray);\n  return children.some(checker);\n}\n\nfunction arraysEqual(match, left, right) {\n  return left.length === right.length && left.every((el, i) => match(el, right[i]));\n}\n\nfunction childrenToArray(children) {\n  const result = [];\n\n  const push = (el) => {\n    if (el === null || el === false || typeof el === 'undefined') return;\n    result.push(el);\n  };\n\n  if (Array.isArray(children)) {\n    children.forEach(push);\n  } else {\n    push(children);\n  }\n  return result;\n}\n\nexport function childrenToSimplifiedArray(nodeChildren, isLoose = false) {\n  const childrenArray = childrenToArray(nodeChildren);\n  const simplifiedArray = [];\n\n  for (let i = 0; i < childrenArray.length; i += 1) {\n    const child = childrenArray[i];\n    const previousChild = simplifiedArray.pop();\n\n    if (typeof previousChild === 'undefined') {\n      simplifiedArray.push(child);\n    } else if (isTextualNode(child) && isTextualNode(previousChild)) {\n      simplifiedArray.push(previousChild + child);\n    } else {\n      simplifiedArray.push(previousChild);\n      simplifiedArray.push(child);\n    }\n  }\n\n  if (isLoose) {\n    return simplifiedArray.map((x) => (typeof x === 'string' ? trim(x) : x));\n  }\n\n  return simplifiedArray;\n}\n\nfunction isTextualNode(node) {\n  return typeof node === 'string' || typeof node === 'number';\n}\n\nexport function isReactElementAlike(arg, adapter) {\n  return adapter.isValidElement(arg) || isTextualNode(arg) || Array.isArray(arg);\n}\n\n// TODO(lmr): can we get rid of this outside of the adapter?\nexport function withSetStateAllowed(fn) {\n  // NOTE(lmr):\n  // this is currently here to circumvent a React bug where `setState()` is\n  // not allowed without global being defined.\n  let cleanup = false;\n  if (typeof global.document === 'undefined') {\n    cleanup = true;\n    global.document = {};\n  }\n  fn();\n  if (cleanup) {\n    // This works around a bug in node/jest in that developers aren't able to\n    // delete things from global when running in a node vm.\n    global.document = undefined;\n    delete global.document;\n  }\n}\n\nexport function AND(fns) {\n  const fnsReversed = fns.slice().reverse();\n  return (x) => fnsReversed.every((fn) => fn(x));\n}\n\nexport function displayNameOfNode(node) {\n  if (!node) return null;\n\n  const { type } = node;\n\n  if (!type) return null;\n\n  return type.displayName || (typeof type === 'function' ? functionName(type) : type.name || type);\n}\n\nexport function sym(s) {\n  return typeof Symbol === 'function' ? Symbol.for(`enzyme.${s}`) : s;\n}\n\nexport function privateSet(obj, prop, value) {\n  Object.defineProperty(obj, prop, {\n    value,\n    enumerable: false,\n    writable: true,\n  });\n}\n\nexport function cloneElement(adapter, el, props) {\n  return adapter.createElement(\n    el.type,\n    { ...el.props, ...props },\n  );\n}\n\nexport function spyMethod(instance, methodName, getStub = () => {}) {\n  let lastReturnValue;\n  const originalMethod = instance[methodName];\n  const hasOwn = has(instance, methodName);\n  let descriptor;\n  if (hasOwn) {\n    descriptor = Object.getOwnPropertyDescriptor(instance, methodName);\n  }\n  Object.defineProperty(instance, methodName, {\n    configurable: true,\n    enumerable: !descriptor || !!descriptor.enumerable,\n    value: getStub(originalMethod) || function spied(...args) {\n      const result = originalMethod.apply(this, args);\n      lastReturnValue = result;\n      return result;\n    },\n  });\n  return {\n    restore() {\n      if (hasOwn) {\n        if (descriptor) {\n          Object.defineProperty(instance, methodName, descriptor);\n        } else {\n          /* eslint-disable no-param-reassign */\n          instance[methodName] = originalMethod;\n          /* eslint-enable no-param-reassign */\n        }\n      } else {\n        /* eslint-disable no-param-reassign */\n        delete instance[methodName];\n        /* eslint-enable no-param-reassign */\n      }\n    },\n    getLastReturnValue() {\n      return lastReturnValue;\n    },\n  };\n}\n\nexport { default as shallowEqual } from 'enzyme-shallow-equal';\n\nexport function isEmptyValue(renderedValue) {\n  return renderedValue === null || renderedValue === false;\n}\n\nexport function renderedDive(nodes) {\n  if (isEmptyValue(nodes)) {\n    return true;\n  }\n\n  return [].concat(nodes).every((n) => {\n    if (n) {\n      const { rendered } = n;\n      return isEmptyValue(rendered) || renderedDive(rendered);\n    }\n\n    return isEmptyValue(n);\n  });\n}\n\nexport function loadCheerioRoot(html) {\n  if (!html) {\n    return cheerio.root();\n  }\n\n  if (!isHtml(html)) {\n    // use isDocument=false to create fragment\n    return cheerio.load(html, null, false).root();\n  }\n\n  return cheerio.load('')(html);\n}\n"]}